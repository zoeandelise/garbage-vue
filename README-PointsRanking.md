# 垃圾分类管理系统 - 积分排行模块

## 模块概述

积分排行模块是垃圾分类管理系统的重要组成部分，主要用于展示用户积分排名情况和管理积分规则。该模块通过可视化的方式呈现用户参与垃圾分类的积极性，同时为管理员提供灵活的积分规则配置功能，以便根据实际情况调整激励机制。

## 功能清单

### 1. 用户积分排行榜

- 展示用户积分排名情况
- 支持查看不同范围的排名（前10名、前20名、前50名、前100名）
- 显示用户名、积分、投递次数、最后投递时间等信息
- 支持排行榜数据导出功能
- 对前三名用户进行特殊标识

### 2. 积分规则配置

- 基础积分规则设置：
  - 积分有效期配置
  - 每日投递上限设置
  - 每日积分上限设置

- 垃圾类型积分规则：
  - 可回收物积分系数设置
  - 有害垃圾积分系数设置
  - 厨余垃圾积分系数设置
  - 其他垃圾积分系数设置
  - 支持按重量或按次数计算积分

- 活动积分规则：
  - 连续投递奖励机制
  - 特殊活动积分加成设置
  - 活动时间范围配置
  - 活动积分倍数设置

## 技术实现

### 前端实现

1. **用户积分排行榜页面 (`ranking-list.vue`)**
   - 使用Element UI的表格组件展示排行数据
   - 实现排名范围筛选功能
   - 为前三名用户添加特殊样式标识
   - 实现数据导出功能

2. **积分规则配置页面 (`points-rule.vue`)**
   - 使用Element UI的标签页组件分类展示不同类型的规则
   - 实现表单验证，确保规则配置的合理性
   - 使用表格组件管理不同垃圾类型的积分系数
   - 实现活动规则的条件显示

### API接口

1. **积分排行API (`adminStatistics.js`)**
   - `getUserPointsRanking(query)`: 获取用户积分排行数据
   - `getAdminDashboardStats()`: 获取管理员仪表盘统计数据

2. **积分规则API (`pointsRule.js`)**
   - `getPointsRuleConfig()`: 获取积分规则配置
   - `updatePointsRuleConfig(data)`: 更新积分规则配置

### 数据模型

1. **用户积分排行数据结构**
```javascript
{
  rank: Number,          // 排名
  userName: String,      // 用户名
  points: Number,        // 积分
  deliveryCount: Number, // 投递次数
  lastDeliveryTime: String // 最后投递时间
}
```

2. **积分规则配置数据结构**
```javascript
{
  // 基础规则
  pointsExpireDays: Number,      // 积分有效期(天)
  dailyDeliveryLimit: Number,    // 每日投递上限
  dailyPointsLimit: Number,      // 每日积分上限
  
  // 连续投递奖励
  continuousDeliveryEnabled: Boolean, // 是否启用连续投递奖励
  continuousDays: Number,        // 连续投递天数
  continuousBonus: Number,       // 奖励积分
  
  // 活动规则
  activityEnabled: Boolean,      // 是否启用活动加成
  activityName: String,          // 活动名称
  activityStartDate: Date,       // 活动开始时间
  activityEndDate: Date,         // 活动结束时间
  activityMultiplier: Number,    // 积分倍数
  
  // 垃圾类型规则
  garbageTypeRules: [
    {
      typeName: String,          // 垃圾类型名称
      typeCode: String,          // 类型编码
      calculationType: Number,   // 计算方式(1:按重量, 2:按次数)
      pointsFactor: Number       // 积分系数
    }
  ]
}
```

## 使用说明

### 查看用户积分排行榜

1. 在系统导航栏中点击"积分与排行" -> "用户积分榜"
2. 在页面上方可选择查看不同范围的排名
3. 点击"刷新"按钮可获取最新排行数据
4. 点击"导出"按钮可导出当前排行数据
5. 点击用户行的"查看详情"可查看该用户的详细信息

### 配置积分规则

1. 在系统导航栏中点击"积分与排行" -> "积分规则配置"，或在用户积分榜页面点击"积分规则配置"按钮
2. 在"基础积分规则"标签页中设置积分有效期、每日投递上限和积分上限
3. 在"垃圾类型积分规则"标签页中配置不同垃圾类型的积分计算方式和系数
4. 在"活动积分规则"标签页中设置连续投递奖励和特殊活动加成
5. 点击"保存配置"按钮提交规则设置
6. 点击"重置"按钮可恢复上一次保存的配置

## 注意事项

1. 积分规则修改后立即生效，但不会影响已经发放的积分
2. 特殊活动时间范围必须合理设置，避免与其他活动冲突
3. 垃圾类型积分系数建议根据实际情况合理配置，以鼓励用户正确分类垃圾
4. 每日积分上限设置为0表示不限制每日可获得的积分数量
5. 积分有效期设置为0表示积分永不过期

## 未来计划

1. 添加积分历史趋势图表，直观展示用户积分变化情况
2. 实现积分预警机制，当用户积分即将过期时发送提醒
3. 增加积分兑换功能，允许用户使用积分兑换实物奖励
4. 添加部门或团队排行榜，促进团队间的良性竞争
5. 实现积分规则模板功能，方便快速切换不同的积分策略 